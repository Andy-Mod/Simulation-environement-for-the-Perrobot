#!/bin/python3

import rospy
from std_msgs.msg import Float64
from numpy import pi

RATE = 10
REPEAT = 10  

alpha, beta = pi/2, pi

topics = [
    "/perrobot_controller/FL_HFE_joint/command",
    "/perrobot_controller/FL_KFE_joint/command",
    "/perrobot_controller/FR_HFE_joint/command",
    "/perrobot_controller/FR_KFE_joint/command",
    "/perrobot_controller/HR_HFE_joint/command",
    "/perrobot_controller/HR_KFE_joint/command",
    "/perrobot_controller/HL_HFE_joint/command",
    "/perrobot_controller/HL_KFE_joint/command"
]

values = [
    alpha,
    beta, 
    alpha,
    beta,
    -alpha,
    -beta,
    -alpha,
    -beta
]

def publishing_init_joint_poses():
    rospy.init_node('init_joint_command_publisher')

    publishers = []
    for topic in topics:
        publishers.append(rospy.Publisher(topic, Float64, queue_size=10))

    rate = rospy.Rate(RATE)
    for _ in range(REPEAT):  
        for i in range(len(topics)):
            message = Float64()
            message.data = values[i]
            publishers[i].publish(message)
            print(f"Publishing on {topics[i]}: {values[i]}")
        
        rate.sleep()

if __name__ == '__main__':
    publishing_init_joint_poses()
    rospy.signal_shutdown("Done publishing")
#!/bin/python3

import numpy as np
from numpy import arccos, arcsin, pi, cos, sin

def angles_for_height(h, L, cut=100, Rpose='x'):
    path = np.linspace(0, h, cut)
    Values = [[pi/2, pi, pi/2, pi, -pi/2, -pi, -pi/2, -pi]]
    
    Values.extend(hight_to_angles(height, L, Rpose) for height in path)
    
    return Values

def hight_to_angles(h, L, Rpose='x', s=False):
    arg = 0.5 * (h / L)
    
    alpha = arccos(arg)
    gamma = arcsin(arg)
    beta = gamma - alpha - pi / 2
    
    a, b = round(alpha, 2), round(beta, 2)
    
    if Rpose == 'x':
        values = [a, b, a, b, -a, -b, -a, -b]
    elif Rpose == 'nx':
        values = [-a, -b, -a, -b, a, b, a, b]
    elif Rpose == 'cc':
        values = [-a, -b, -a, -b, -a, -b, -a, -b]
    elif Rpose == 'ncc':
        values = [a, b, a, b, a, b, a, b]
    else:
        values = None
        
    return (a, b) if s else values

def angles_to_height(alpha, L):
    return round(2 * L * cos(alpha), 2)

def generate_sequences(a1, a2, n):
    a1 = np.array(a1)
    a2 = np.array(a2)
    
    return [(1 - t) * a1 + t * a2 for t in np.linspace(0, 1, n + 1)]

def from_x_to_nx(h, L, cut=100):
    x = np.array(hight_to_angles(h, L, 'x'))
    nx = np.array(hight_to_angles(h, L, 'nx'))
    
    return generate_sequences(x, nx, cut)

def rotx(alpha):
    c, s = cos(alpha), sin(alpha)
    return np.array([[1, 0, 0], [0, c, -s], [0, s, c]])

def roty(beta):
    c, s = cos(beta), sin(beta)
    return np.array([[c, 0, s], [0, 1, 0], [-s, 0, c]])

def rotz(gamma):
    c, s = cos(gamma), sin(gamma)
    return np.array([[c, -s, 0], [s, c, 0], [0, 0, 1]])

def rotxyz(alpha, beta, gamma):
    return rotx(alpha).dot(roty(beta)).dot(rotz(gamma))

def homog_transxyz(dx, dy, dz):
    return np.array([[1, 0, 0, dx], [0, 1, 0, dy], [0, 0, 1, dz], [0, 0, 0, 1]])

def homog_transform(dx, dy, dz, alpha, beta, gamma):
    rot4x4 = np.eye(4)
    rot4x4[:3, :3] = rotxyz(alpha, beta, gamma)
    return np.dot(homog_transxyz(dx, dy, dz), rot4x4)

def homog_transform_inverse(matrix):
    inv = np.eye(4)
    inv[:3, :3] = matrix[:3, :3].T
    inv[:3, 3] = -np.dot(inv[:3, :3], matrix[:3, 3])
    return inv
#!/bin/python3

import rospy
from std_msgs.msg import Float64
from robot_utils import angles_for_hight

RATE = 10
INIT_HEIGHT = 0.22
HALF_LEG_LENGTH = 0.16

Values = angles_for_hight(INIT_HEIGHT, HALF_LEG_LENGTH, Rpose='cc')
print(Values)

topics = [
    "/perrobot_controller/FL_HFE_joint/command",
    "/perrobot_controller/FL_KFE_joint/command",
    "/perrobot_controller/FR_HFE_joint/command",
    "/perrobot_controller/FR_KFE_joint/command",
    "/perrobot_controller/HR_HFE_joint/command",
    "/perrobot_controller/HR_KFE_joint/command",
    "/perrobot_controller/HL_HFE_joint/command",
    "/perrobot_controller/HL_KFE_joint/command"
]

def publishing_init_joint_poses():
    rospy.init_node('init_joint_command_publisher')

    publishers = []
    for topic in topics:
        publishers.append(rospy.Publisher(topic, Float64, queue_size=10))

    rate = rospy.Rate(RATE)
    for values in Values:
        for i in range(len(topics)):
            message = Float64()
            message.data = values[i]
            publishers[i].publish(message)
            print(f"Publishing on {topics[i]}: {values[i]}")
        
        rate.sleep()

if __name__ == '__main__':
    publishing_init_joint_poses()
    rospy.signal_shutdown("Done publishing")#!/bin/python3

import rospy
from std_msgs.msg import Float64
from robot_utils import hight_to_angles

RATE = 10
INIT_HEIGHT = 0.20
HALF_LEG_LENGTH = 0.16
REPEAT = 20

alpha, beta = hight_to_angles(INIT_HEIGHT, HALF_LEG_LENGTH)

topics = [
    "/perrobot_controller/FL_HFE_joint/command",
    "/perrobot_controller/FL_KFE_joint/command",
    "/perrobot_controller/FR_HFE_joint/command",
    "/perrobot_controller/FR_KFE_joint/command",
    "/perrobot_controller/HR_HFE_joint/command",
    "/perrobot_controller/HR_KFE_joint/command",
    "/perrobot_controller/HL_HFE_joint/command",
    "/perrobot_controller/HL_KFE_joint/command"
]

values = [
    alpha,
    beta, 
    alpha,
    beta,
    -alpha,
    -beta,
    -alpha,
    -beta
]

def publishing_init_joint_poses():
    rospy.init_node('init_joint_command_publisher')

    publishers = []
    for topic in topics:
        publishers.append(rospy.Publisher(topic, Float64, queue_size=10))

    rate = rospy.Rate(RATE)
    for _ in range(REPEAT):  
        for i in range(len(topics)):
            message = Float64()
            message.data = values[i]
            publishers[i].publish(message)
            print(f"Publishing on {topics[i]}: {values[i]}")
        
        rate.sleep()

if __name__ == '__main__':
    publishing_init_joint_poses()
    rospy.signal_shutdown("Done publishing")#!/bin/python3

import rospy
from std_msgs.msg import Float64
from robot_utils import from_x_to_nx

RATE = 10
INIT_HEIGHT = 0.27
HALF_LEG_LENGTH = 0.16

Values = from_x_to_nx(INIT_HEIGHT, HALF_LEG_LENGTH, 100)
print(Values)

topics = [
    "/perrobot_controller/FL_HFE_joint/command",
    "/perrobot_controller/FL_KFE_joint/command",
    "/perrobot_controller/FR_HFE_joint/command",
    "/perrobot_controller/FR_KFE_joint/command",
    "/perrobot_controller/HR_HFE_joint/command",
    "/perrobot_controller/HR_KFE_joint/command",
    "/perrobot_controller/HL_HFE_joint/command",
    "/perrobot_controller/HL_KFE_joint/command"
]

def publishing_init_joint_poses():
    rospy.init_node('init_joint_command_publisher')

    publishers = []
    for topic in topics:
        publishers.append(rospy.Publisher(topic, Float64, queue_size=10))

    rate = rospy.Rate(RATE)
    for values in Values:
        for i in range(len(topics)):
            message = Float64()
            message.data = values[i]
            publishers[i].publish(message)
            print(f"Publishing on {topics[i]}: {values[i]}")
        
        rate.sleep()

if __name__ == '__main__':
    publishing_init_joint_poses()
    rospy.signal_shutdown("Done publishing")#!/bin/python3

import rospy
from std_msgs.msg import Float64
from robot_utils import angles_for_hight

RATE = 10
INIT_HEIGHT = 0.22
HALF_LEG_LENGTH = 0.16

Values = angles_for_hight(INIT_HEIGHT, HALF_LEG_LENGTH, Rpose='ncc')
print(Values)

topics = [
    "/perrobot_controller/FL_HFE_joint/command",
    "/perrobot_controller/FL_KFE_joint/command",
    "/perrobot_controller/FR_HFE_joint/command",
    "/perrobot_controller/FR_KFE_joint/command",
    "/perrobot_controller/HR_HFE_joint/command",
    "/perrobot_controller/HR_KFE_joint/command",
    "/perrobot_controller/HL_HFE_joint/command",
    "/perrobot_controller/HL_KFE_joint/command"
]

def publishing_init_joint_poses():
    rospy.init_node('init_joint_command_publisher')

    publishers = []
    for topic in topics:
        publishers.append(rospy.Publisher(topic, Float64, queue_size=10))

    rate = rospy.Rate(RATE)
    for values in Values:
        for i in range(len(topics)):
            message = Float64()
            message.data = values[i]
            publishers[i].publish(message)
            print(f"Publishing on {topics[i]}: {values[i]}")
        
        rate.sleep()

if __name__ == '__main__':
    publishing_init_joint_poses()
    rospy.signal_shutdown("Done publishing")#!/bin/python3

import rospy
from std_msgs.msg import Float64
from robot_utils import angles_for_height

RATE = 10
INIT_HEIGHT = 0.22
HALF_LEG_LENGTH = 0.16

Values = angles_for_height(INIT_HEIGHT, HALF_LEG_LENGTH, Rpose='nx')
print(Values)

topics = [
    "/perrobot_controller/FL_HFE_joint/command",
    "/perrobot_controller/FL_KFE_joint/command",
    "/perrobot_controller/FR_HFE_joint/command",
    "/perrobot_controller/FR_KFE_joint/command",
    "/perrobot_controller/HR_HFE_joint/command",
    "/perrobot_controller/HR_KFE_joint/command",
    "/perrobot_controller/HL_HFE_joint/command",
    "/perrobot_controller/HL_KFE_joint/command"
]

def publishing_init_joint_poses():
    rospy.init_node('init_joint_command_publisher')

    publishers = []
    for topic in topics:
        publishers.append(rospy.Publisher(topic, Float64, queue_size=10))

    rate = rospy.Rate(RATE)
    for values in Values:
        for i in range(len(topics)):
            message = Float64()
            message.data = values[i]
            publishers[i].publish(message)
            print(f"Publishing on {topics[i]}: {values[i]}")
        
        rate.sleep()

if __name__ == '__main__':
    publishing_init_joint_poses()
    rospy.signal_shutdown("Done publishing")#!/bin/python3

import rospy
from std_msgs.msg import Float64
from robot_utils import angles_for_height

RATE = 10
INIT_HEIGHT = 0.27
HALF_LEG_LENGTH = 0.16

Values = angles_for_height(INIT_HEIGHT, HALF_LEG_LENGTH, Rpose='x')
print(Values)

topics = [
    "/perrobot_controller/FL_HFE_joint/command",
    "/perrobot_controller/FL_KFE_joint/command",
    "/perrobot_controller/FR_HFE_joint/command",
    "/perrobot_controller/FR_KFE_joint/command",
    "/perrobot_controller/HR_HFE_joint/command",
    "/perrobot_controller/HR_KFE_joint/command",
    "/perrobot_controller/HL_HFE_joint/command",
    "/perrobot_controller/HL_KFE_joint/command"
]

def publishing_init_joint_poses():
    rospy.init_node('init_joint_command_publisher')

    publishers = []
    for topic in topics:
        publishers.append(rospy.Publisher(topic, Float64, queue_size=10))

    rate = rospy.Rate(RATE)
    for values in Values:
        for i in range(len(topics)):
            message = Float64()
            message.data = values[i]
            publishers[i].publish(message)
            print(f"Publishing on {topics[i]}: {values[i]}")
        
        rate.sleep()

if __name__ == '__main__':
    publishing_init_joint_poses()
    rospy.signal_shutdown("Done publishing")